(this["webpackJsonprandevou-react"]=this["webpackJsonprandevou-react"]||[]).push([[0],{141:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(28),s=n.n(i),o=(n(75),n(4)),l=n(5),c=n(6),u=n(7),d=n(13),h=(n(76),function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Randevou Api REACT client"))}),p=(n(77),[{name:"Home",path:"/",exact:!0},{name:"Messages",path:"/messages"},{name:"Friends",path:"/friends"},{name:"Search",path:"/search"},{name:"Login",path:"/login"}]),m=function(){var e=p.map((function(e){return r.a.createElement("li",{key:e.name},r.a.createElement(d.c,{to:e.path,exact:!!e.exact&&e.exact},e.name))}));return r.a.createElement("nav",{className:"main"},r.a.createElement("ul",null,e))},v=n(12),g=n(19),f=n(9),y=n(36),E={loginInfo:{loggedIn:!1,identity:"",apiKey:""}};var b=Object(y.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;return"LOGIN_SUCCESSFUL"===t.type?Object(f.a)({},e,{loginInfo:{loggedIn:!0,identity:t.data.identity,apiKey:t.data.apiKey}}):"LOGOUT"===t.type?Object(f.a)({},e,{loginInfo:{loggedIn:!1,identity:"",apiKey:""}}):e})),C=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"GetIdentity",value:function(){return b.getState().loginInfo.identity}},{key:"BuildAddress",value:function(e,t){return null==t&&void 0===t?e:e=e.replace("{id}",t.toString())}},{key:"GetApiKey",value:function(){return b.getState().loginInfo.apiKey}},{key:"patch",value:function(e,t){var n=this.GetApiKey();null===n&&(n=""),console.log(e);var a=new Headers;return a.append("Content-Type","application/json"),a.append("Authorization",n),fetch(e,{method:"PATCH",headers:a,body:JSON.stringify(t)}).then((function(e){e.ok||Error(e.statusText)})).catch((function(e){return Error(e)}))}},{key:"get",value:function(e){var t=this.GetApiKey();null===t&&(t="");var n=new Headers;return n.append("Content-Type","application/json"),n.append("Authorization",t),fetch(e,{method:"Get",headers:n}).then((function(e){if(!e.ok||204===e.status)throw Error("Nie uda\u0142o si\u0119 pobra\u0107 u\u017cyszkodnika");return e.json().then((function(e){return e}))})).catch((function(e){throw Error(e)}))}},{key:"postSpecific",value:function(e,t){var n=this.GetApiKey();null===n&&(n="");var a=new Headers;return a.append("Content-Type","application/json"),a.append("Authorization",n),fetch(e,{method:"Post",headers:a,body:JSON.stringify(t)}).then((function(e){return e.json().then((function(e){return e}))}))}},{key:"post",value:function(e,t){var n=this.GetApiKey();null===n&&(n="");var a=new Headers;return a.append("Content-Type","application/json"),a.append("Authorization",n),fetch(e,{method:"Post",headers:a,body:JSON.stringify(t)})}},{key:"put",value:function(e,t){var n=this.GetApiKey();null===n&&(n="");var a=new Headers;return a.append("Content-Type","application/json"),a.append("Authorization",n),fetch(e,{method:"Put",headers:a,body:JSON.stringify(t)}).then((function(e){return e.ok||(console.log("Nie uda\u0142o si\u0119 wys\u0142a\u0107 zaproszenia"),console.log(e.json())),e}))}}]),e}();C.ApiEndpoint="https://randevou.azurewebsites.net";var k=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).InterestsEnd=C.ApiEndpoint+"/api/UserDictItems/Interest",e.HairColorsEnd=C.ApiEndpoint+"/api/UserDictItems/HairColors",e.EyesColorsEnd=C.ApiEndpoint+"/api/UserDictItems/EyesColors",e.GetAllInterest=function(){return e.GetDictionaryItems(e.InterestsEnd)},e.GetAllEyesColors=function(){return e.GetDictionaryItems(e.EyesColorsEnd)},e.GetAllHairColors=function(){return e.GetDictionaryItems(e.HairColorsEnd)},e}return Object(l.a)(n,[{key:"GetDictionaryItems",value:function(e){return this.get(e)}}]),n}(C),F=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).usersEnd=C.ApiEndpoint+"/api/Users",e.getAllUsersEnd=e.usersEnd,e.getManyUsersEnd=e.usersEnd+"/List",e.getUserEnd=e.usersEnd+"/{id}",e.patchUserEnd=e.usersEnd,e.deleteUserEnd=e.usersEnd+"/{id}",e.postUserEnd=e.usersEnd,e.getUserDetailsEnd=e.getUserEnd+"/Details",e.putUserDetailsEnd=e.patchUserEnd+"/{id}/Details",e.putAvatar=e.patchUserEnd+"/{id}/Details/avatar",e.putAvatarBase64=e.putAvatar+"/base64",e.getUsersAvatars=e.getManyUsersEnd+"/Avatars/base64img",e}return Object(l.a)(n,[{key:"getManyUsers",value:function(e){return this.postSpecific(this.getManyUsersEnd,e)}},{key:"getUserDetais",value:function(e){return this.get(this.BuildAddress(this.getUserDetailsEnd,e))}},{key:"getUserBasic",value:function(e){return this.get(this.BuildAddress(this.getUserEnd,e))}},{key:"patchtUserBasic",value:function(e){this.patch(this.BuildAddress(this.patchUserEnd),e)}},{key:"patchUserDetails",value:function(e){this.patch(this.BuildAddress(this.putUserDetailsEnd,+this.GetIdentity()),e)}}]),n}(C),j=n(67),O=n.n(j),I=(n(83),function(e,t,n,a){var i;r.a.Fragment;i=n.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id}," ",e.displayName," ")}));var s=n.find((function(e){return e.id==t}));return void 0!==s?r.a.createElement(r.a.Fragment,null,r.a.createElement("select",{id:e,name:e,value:null===s||void 0===s?void 0:s.id,onChange:a},i)):r.a.createElement("select",{id:e,name:e,onChange:a}," ",i)}),S=function(e){var t,n,a,i=e.userFullDto,s=e.eyesColors,o=e.hairColors,l=e.interests,c=e.onFieldChange,u=e.onDictionaryFieldChange,d=e.onDateFieldChange,h=e.onSave,p=i.basic,m=i.details;s.length>0&&(n=s.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id}," ",e.displayName," ")}))),o.length>0&&(a=o.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id}," ",e.displayName," ")})));var v,g=void 0!==m.eyesColor?I("eyesColor",m.eyesColor,s,u):r.a.createElement("select",{id:"eyesColor",name:"eyesColor",onChange:u}," ",n),f=void 0!==m.hairColor?I("hairColor",m.hairColor,o,u):r.a.createElement("select",{id:"hairColor",name:"hairColor",onChange:u}," ",a),y=function(e,t){var n=[{key:"m",text:"male"},{key:"f",text:"female"}].map((function(e){return r.a.createElement("option",{key:e.key,value:e.key},e.text)})),a=r.a.createElement("select",null);switch(e.toLocaleLowerCase()){case"male":case"m":a=r.a.createElement("select",{id:"gender",name:"gender",value:"m",onChange:t},n);break;case"female":case"f":a=r.a.createElement("select",{id:"gender",name:"gender",value:"f",onChange:t},n);break;default:a=r.a.createElement("select",{id:"gender",name:"gender",onChange:t},n)}return a}(null!==(t=p.gender)&&void 0!==t?t:"",u),E=l;E.length>0&&(v=E.map((function(e){var t,n=e.boolValue||void 0!==(null===(t=m.interests)||void 0===t?void 0:t.find((function(t){return t===e.id})));return r.a.createElement("label",{key:e.name},r.a.createElement("input",{type:"checkbox",key:e.name,name:e.id+"",checked:n,onChange:u}),e.displayName)})));return r.a.createElement("div",{style:{display:"inline-grid",width:"35%",margin:"10px"}},r.a.createElement("label",{htmlFor:"userName"},"Nazwa wy\u015bwietlana u\u017cytkownika"),r.a.createElement("input",{type:"text",id:"name",name:"basic_name",value:p.displayName,onChange:c}),r.a.createElement("label",{htmlFor:"region"},"Wojew\xf3dztwo"),r.a.createElement("input",{type:"text",id:"region",name:"region",value:m.region,onChange:c}),r.a.createElement("label",{htmlFor:"city"},"Miasto"),r.a.createElement("input",{type:"text",id:"city",name:"city",value:m.city,onChange:c}),r.a.createElement("label",{htmlFor:"age"},"Data urodzenia"),r.a.createElement(O.a,{name:"basic_birthdate",selected:i.birthDate,onChange:d}),r.a.createElement("label",{htmlFor:"width"},"Wzrost"),r.a.createElement("input",{type:"text",id:"width",name:"width",value:m.width,onChange:c}),r.a.createElement("label",{htmlFor:"heigthFrom"},"Waga"),r.a.createElement("input",{type:"text",id:"heigth",name:"heigth",value:m.heigth,onChange:c}),r.a.createElement("label",{htmlFor:"gender"},"P\u0142e\u0107"),y,r.a.createElement("label",{htmlFor:"tattos"},"Tatua\u017ce"),r.a.createElement("input",{type:"text",id:"tatoos",name:"tatoos",value:m.tatoos,onChange:c}),r.a.createElement("label",{htmlFor:"eyesColor"},"Kolor oczu"),g,r.a.createElement("label",{htmlFor:"hairColor"},"Kolor w\u0142os\xf3w"),f,r.a.createElement("p",null,"Zainteresowania"),v,r.a.createElement("button",{type:"submit",onClick:h},"Zapisz"))},w=n(17),D=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).usersService=new F,e.dictionaryService=new k,e._isMounted=!1,e._interestsLoaded=!1,e._eyesColorsLoaded=!1,e._hairColorsLoaded=!1,e._basicLoaded=!1,e._detailsLoaded=!1,e.state={interests:new Array,eyesColors:new Array,hairColors:new Array,userFullDto:{basic:{},details:{}},selectedInterests:new Array},e.getLoggedUserData=function(){var t=+e.usersService.GetIdentity();e.usersService.getUserBasic(t).then((function(t){var n=t,a=new Date(n.birthDate);e._basicLoaded=!0,e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{basic:n,birthDate:a})})})),e.usersService.getUserDetais(t).then((function(t){var n=t;e._detailsLoaded=!0,e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{details:n})})}))},e.getDictionariesValues=function(){e.dictionaryService.GetAllInterest().then((function(t){e._interestsLoaded=!0,e.setState({interests:t})})),e.dictionaryService.GetAllEyesColors().then((function(t){e._eyesColorsLoaded=!0,e.setState({eyesColors:t})})),e.dictionaryService.GetAllHairColors().then((function(t){e._hairColorsLoaded=!0,e.setState({hairColors:t})}))},e.service=new C,e.onDateFieldChange=function(t){e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{birthDate:t,basic:Object(f.a)({},e.state.userFullDto.basic,{birthDate:new Date(t).toJSON()})})})},e.onFieldChange=function(t){var n=t.target.type,a=t.target.name;if("checkbox"===n){var r=t.target.checked;e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,Object(g.a)({},a,r))})}else if(e._isMounted){var i=t.target.value;a.startsWith("basic_")?(a=a.substring(0,"basic_".length),e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{basic:Object(f.a)({},e.state.userFullDto.basic,Object(g.a)({},a,i))})})):e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{details:Object(f.a)({},e.state.userFullDto.details,Object(g.a)({},a,i))})})}},e.onDictionaryFieldChange=function(t){if("eyesColor"===t.target.name)e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{details:Object(f.a)({},e.state.userFullDto.details,{eyesColor:t.target.value})})});else if("hairColor"===t.target.name)e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{details:Object(f.a)({},e.state.userFullDto.details,{hairColor:t.target.value})})});else if("gender"===t.target.name)e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{basic:Object(f.a)({},e.state.userFullDto.basic,{gender:t.target.value})})});else{var n,a,r,i=null!==(n=e.state.userFullDto.details.interests)&&void 0!==n?n:[];t.target.checked&&!(null===(a=i)||void 0===a?void 0:a.find((function(e){return e==t.target.name})))&&i.push(1*t.target.name),!t.target.checked&&(null===(r=i)||void 0===r?void 0:r.find((function(e){return e==t.target.name})))&&(i=i.filter((function(e){return e!=t.target.name}))),e._isMounted&&e.setState({userFullDto:Object(f.a)({},e.state.userFullDto,{details:Object(f.a)({},e.state.userFullDto.details,{interests:i})})})}},e.onSave=function(){console.log(e.state),e.usersService.patchtUserBasic(e.state.userFullDto.basic),e.usersService.patchUserDetails(e.state.userFullDto.details)},e}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){this._isMounted=!0,this.props.loginInfo.loggedIn&&(this.getLoggedUserData(),this.getDictionariesValues())}},{key:"render",value:function(){if(console.log("profile page render loginInfo:",this.props.loginInfo),!this.props.loginInfo.loggedIn)return r.a.createElement(v.a,{to:"/login"});var e=this.state,t=e.eyesColors,n=e.hairColors,a=e.interests,i=e.userFullDto;return this._basicLoaded&&this._detailsLoaded&&this._hairColorsLoaded&&this._interestsLoaded&&this._eyesColorsLoaded?r.a.createElement("div",{className:"finder"},r.a.createElement(S,{userFullDto:i,eyesColors:t,hairColors:n,interests:a,onFieldChange:this.onFieldChange,onDictionaryFieldChange:this.onDictionaryFieldChange,onDateFieldChange:this.onDateFieldChange,onSave:this.onSave})):r.a.createElement("p",null,"Loading data")}}]),n}(r.a.Component),A=Object(w.b)((function(e,t){return{loginInfo:e.loginInfo}}))(D),M=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).FriendshipQueryEndpoint=C.ApiEndpoint+"/api/UserFriendship",e.GetFriendsListEnd=e.FriendshipQueryEndpoint+"/users/{id}/friends",e.GetFriendshipisRequestsEnd=e.FriendshipQueryEndpoint+"/users/{id}/requests",e.GetPossibleActionEnd=e.FriendshipQueryEndpoint+"/PossibleRequestsActions",e.SendInvitationEnd=e.FriendshipQueryEndpoint+"/Invitation",e.SetFriendshipStatusEnd=e.FriendshipQueryEndpoint+"/FriendshipStatusAction",e.GetFriendshipStatusNend=e.FriendshipQueryEndpoint+"/users/{id}/RelationStatus/",e}return Object(l.a)(n,[{key:"GetFriendsList",value:function(){return this.get(this.BuildAddress(this.GetFriendsListEnd,+this.GetIdentity()))}},{key:"GetFriendshipsRequestsList",value:function(){return this.get(this.BuildAddress(this.GetFriendshipisRequestsEnd,+this.GetIdentity()))}},{key:"SendInvitation",value:function(e){var t=+this.GetIdentity(),n=this.SendInvitationEnd,a={fromUserId:t,toUserId:e};return this.put(n,a)}},{key:"GetFriendshipStatus",value:function(e,t){var n=this.BuildAddress(this.GetFriendshipStatusNend,e);n+=t;var a=this.GetApiKey();null===a&&(a="");var r=new Headers;return r.append("Content-Type","application/json"),r.append("Authorization",a),r.append("Accept","application/json"),fetch(n,{method:"Get",headers:r}).then((function(n){return n.json().then((function(n){return console.log(e),console.log(t),console.log(n),n}))}))}},{key:"AreFriends",value:function(e,t){return this.GetFriendshipStatus(e,t).then((function(e){return"none"===e.toLowerCase()}))}},{key:"AcceptFriendship",value:function(e){var t=+this.GetIdentity(),n=this.BuildAddress(this.SetFriendshipStatusEnd,t),a={toUserId:e,fromUserId:t,action:"Accept"};return this.put(n,a)}},{key:"RemoveFriend",value:function(e){var t=+this.GetIdentity(),n=this.BuildAddress(this.SetFriendshipStatusEnd,t),a={fromUserId:t,toUserId:e,action:"Delete"};return this.put(n,a)}}]),n}(C),U=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).calculateAge=function(e){var t=Date.now()-e,n=new Date(t);return Math.abs(n.getUTCFullYear()-1970)},e}return Object(l.a)(n,[{key:"render",value:function(){var e,t,n,r=this.props.user;n=null!==(e=null===(t=r.birthDate)||void 0===t?void 0:t.slice(0,10))&&void 0!==e?e:"";var i="";switch(r.gender){case"m":i="male";break;case"f":i="female"}return a.createElement(a.Fragment,null,a.createElement("div",{key:r.id},"U\u017cytkownik ",r.displayName," ",a.createElement("br",null),"P\u0142e\u0107 ",i," ",a.createElement("br",null),"Wiek ",this.calculateAge(Date.parse(n))," ",a.createElement("br",null)))}}]),n}(a.Component),G=function(e){var t="/user/".concat(e.user.id),n="/messages/conversation/".concat(e.user.id);return a.createElement(a.Fragment,null,a.createElement(U,{user:e.user})," |",a.createElement(d.b,{to:t},"Go")," ","|",a.createElement(d.b,{to:n},"Send message")," |")},L=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i)))._isMounted=!1,e.state={friendshipStatus:""},e.friendshipService=new M,e.removeFriend=function(t){e.friendshipService.RemoveFriend(t),e.setState({friendshipStatus:"none"}),null!==e.props.callBack&&void 0!==e.props.callBack&&e.props.callBack("removeFriend")},e.addToFriends=function(t){e.friendshipService.SendInvitation(t),e.setState({friendshipStatus:"created"}),null!==e.props.callBack&&void 0!==e.props.callBack&&e.props.callBack("addFriend")},e.acceptFriendship=function(t){e.friendshipService.AcceptFriendship(t),e.setState({friendshipStatus:"friends"}),null!==e.props.callBack&&void 0!==e.props.callBack&&e.props.callBack("addFriend")},e.getUserFriendshipsActions=function(){var t,n=e.state.friendshipStatus,a=e.props.userId;switch(n.toLocaleLowerCase()){case"friends":t=r.a.createElement("button",{key:a,onClick:function(){return e.removeFriend(a)}},"Remove from friends");break;case"invited":t=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{key:a+"accept",onClick:function(){return e.acceptFriendship(a)}},"Accept"),r.a.createElement("button",{key:a+"remove",onClick:function(){return e.removeFriend(a)}},"Remove from friends"));break;case"created":t=r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Invitation to friends has been sent"),r.a.createElement("button",{key:a,onClick:function(){return e.removeFriend(a)}},"Remove from friends"));break;case"none":t=r.a.createElement("button",{key:a,onClick:function(){return e.addToFriends(a)}},"Add to friends")}return t},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=+this.friendshipService.GetIdentity();this.friendshipService.GetFriendshipStatus(t,this.props.userId).then((function(t){e._isMounted&&e.setState({friendshipStatus:t})}))}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){if(0===this.props.userId)return r.a.createElement(r.a.Fragment,null);var e=this.getUserFriendshipsActions();return r.a.createElement(r.a.Fragment,null,e)}}]),n}(r.a.Component),_=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={friendshipStatus:"friends"},e.callBack=function(t){console.log("friendComponent callBack"),null!==e.props.callBack&&void 0!==e.props.callBack&&("removeFriend"===t?e.props.callBack("friends"):e.props.callBack())},e}return Object(l.a)(n,[{key:"render",value:function(){var e;return a.createElement(a.Fragment,null,a.createElement(G,{user:this.props.user}),a.createElement(L,{userId:null!==(e=this.props.user.id)&&void 0!==e?e:0,callBack:this.callBack}))}}]),n}(a.Component),x=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._isMsounted=!1,e.state={friends:new Array,invitations:new Array},e.friendsService=new M,e.usersService=new F,e.getFriends=function(){e.friendsService.GetFriendsList().then((function(t){e.usersService.getManyUsers(t).then((function(t){e._isMsounted&&e.setState({friends:t})}))}))},e.getInvitations=function(){e.friendsService.GetFriendshipsRequestsList().then((function(t){e.usersService.getManyUsers(t).then((function(t){e._isMsounted&&e.setState({invitations:t})}))}))},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this._isMsounted=!0,this.props.loginInfo.loggedIn&&(this.getFriends(),this.getInvitations())}},{key:"componentWillUnmount",value:function(){this._isMsounted=!1}},{key:"callBack",value:function(e){"invitations"===e?this.getInvitations():("friends"===e||this.getInvitations(),this.getFriends())}},{key:"render",value:function(){var e=this;if(!this.props.loginInfo.loggedIn)return r.a.createElement(v.a,{to:"/login"});var t={border:"1px solid gray",margin:"10px"},n=this.state.friends.map((function(n){return r.a.createElement("div",{key:n.id,style:t},r.a.createElement(_,{user:n,callBack:e.callBack.bind(e)}))})),a=this.state.invitations.map((function(n){return r.a.createElement("div",{key:n.id,style:t},r.a.createElement(_,{user:n,callBack:e.callBack.bind(e)}))}));return r.a.createElement("div",{className:"Friends"},r.a.createElement("h3",null,"Friends"),n,r.a.createElement("h3",null,"Invitations to friends"),a)}}]),n}(r.a.Component),B=Object(w.b)((function(e,t){return{loginInfo:e.loginInfo}}))(x),N=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).MessagesEndp=C.ApiEndpoint+"/api/Messages",e.ConversationsEndp=e.MessagesEndp+"/Conversation/{id}",e.SpeakersEndp=e.MessagesEndp+"/{id}/Speakers",e.WholeConversationEndp=e.MessagesEndp+"/Conversation",e.MessageMarkReadEndp=e.MessagesEndp+"/MarkRead",e.MessageMarkUnreadEndp=e.MessagesEndp+"/MarkUnread",e}return Object(l.a)(n,[{key:"GetLastMessages",value:function(){var e=+this.GetIdentity(),t=this.BuildAddress(this.ConversationsEndp,e);return this.get(t)}},{key:"GetConversation",value:function(e){var t={firstUserId:+this.GetIdentity(),secondUserId:+e},n=this.BuildAddress(this.WholeConversationEndp,t.firstUserId);return this.postSpecific(n,t)}},{key:"SendMessage",value:function(e,t){var n={receiverId:e,content:t,senderId:+this.GetIdentity()};console.log(n);var a=this.BuildAddress(this.MessagesEndp);return this.post(a,n)}}]),n}(C),z=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e={color:"white",backgroundColor:"violet",padding:"10px",fontFamily:"Arial",margin:"10px",a:{color:"red"}},t=this.props.conversations.map((function(t){var n="/messages/conversation/".concat(t.speakerId);return a.createElement("div",{key:t.speakerId,style:e},t.messageDate," | ",a.createElement("strong",null," ",t.speakerName)," ",a.createElement("br",null),t.messageShortContent,a.createElement("hr",null),a.createElement(d.b,{to:n},"Przejd\u017a"))}));return a.createElement("div",null,t)}}]),n}(a.Component),T=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={conversations:new Array},e.lastMessagesIntervalId=void 0,e.service=new N,e.getLastMessage=function(){e.service.GetLastMessages().then((function(t){e.setState({conversations:t})}))},e.componentWillUnmount=function(){clearInterval(e.lastMessagesIntervalId)},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.props.loginInfo.loggedIn&&(this.getLastMessage(),this.lastMessagesIntervalId=setInterval(this.getLastMessage,3e3))}},{key:"render",value:function(){return this.props.loginInfo.loggedIn?r.a.createElement("div",{className:"Messages"},r.a.createElement(z,{conversations:this.state.conversations})):r.a.createElement(v.a,{to:"/login"})}}]),n}(r.a.Component),W=Object(w.b)((function(e,t){return{loginInfo:e.loginInfo}}))(T),q=function e(){Object(o.a)(this,e),this.name=void 0,this.region=void 0,this.city=void 0,this.agefrom=void 0,this.ageto=void 0,this.heightfrom=void 0,this.heightto=void 0,this.widthfrom=void 0,this.widthto=void 0,this.gender=void 0,this.tatoos=void 0,this.interestids=void 0,this.haircolor=void 0,this.eyescolor=void 0,this.isonline=void 0},R=function(e){var t=e.query,n=e.onFieldChange;return r.a.createElement(r.a.Fragment,null,r.a.createElement("label",{htmlFor:"userName"},"Nazwa u\u017cytkownika"),r.a.createElement("input",{type:"text",id:"name",name:"name",value:t.name||"",onChange:n}),r.a.createElement("label",{htmlFor:"region"},"Wojew\xf3dztwo"),r.a.createElement("input",{type:"text",id:"region",name:"region",value:t.region||"",onChange:n}),r.a.createElement("label",{htmlFor:"city"},"Miasto"),r.a.createElement("input",{type:"text",id:"city",name:"city",value:t.city||"",onChange:n}),r.a.createElement("label",{htmlFor:"ageFrom"},"Wiek od"),r.a.createElement("input",{type:"text",id:"agefrom",name:"agefrom",value:t.agefrom||"",onChange:n}),r.a.createElement("label",{htmlFor:"ageTo"},"Wiek do"),r.a.createElement("input",{type:"text",id:"ageto",name:"ageto",value:t.ageto||"",onChange:n}),r.a.createElement("label",{htmlFor:"widthFrom"},"Wzrost od"),r.a.createElement("input",{type:"text",id:"widthfrom",name:"widthfrom",value:t.widthfrom||"",onChange:n}),r.a.createElement("label",{htmlFor:"widthTo"},"Wzrost do"),r.a.createElement("input",{type:"text",id:"widthto",name:"widthto",value:t.widthto||"",onChange:n}),r.a.createElement("label",{htmlFor:"heigthFrom"},"Waga od"),r.a.createElement("input",{type:"text",id:"heigthFrom",name:"heigthFrom",value:t.heightfrom||"",onChange:n}),r.a.createElement("label",{htmlFor:"heigthTo"},"Waga do"),r.a.createElement("input",{type:"text",id:"heigthTo",name:"heigthTo",value:t.heightto||"",onChange:n}),r.a.createElement("label",{htmlFor:"gender"},"P\u0142e\u0107"),r.a.createElement("select",{id:"gender",name:"gender",onChange:n},r.a.createElement("option",{value:"m"},"M\u0119\u017cczyzna"),r.a.createElement("option",{value:"f"},"Kobieta")),r.a.createElement("label",{htmlFor:"tattos"},"Tatua\u017ce"),r.a.createElement("input",{type:"checkbox",id:"tatoos",name:"tatoos",checked:t.tatoos||!1,onChange:n}))},K=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).postUserFindEnd=C.ApiEndpoint+"/api/UserFinder",e}return Object(l.a)(n,[{key:"searchUsers",value:function(e){return this.postSpecific(this.postUserFindEnd,e).then((function(e){return(new F).getManyUsers(e)}))}}]),n}(C),H=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.users.map((function(e){return r.a.createElement("div",{style:{border:"1px solid gray"},key:e.id},r.a.createElement(G,{user:e}))}));return r.a.createElement(r.a.Fragment,null,e)}}]),n}(a.Component),P=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._isMounted=!1,e.state={queryDto:new q,interests:new Array,eyesColors:new Array,hairColors:new Array,searchResult:new Array},e.dictionaryService=new k,e.searchService=new K,e.onFieldChange=function(t){var n=t.target.value,a=t.target.checked,r=t.target.name;"checkbox"===t.target.type?e._isMounted&&e.setState({queryDto:Object(f.a)({},e.state.queryDto,Object(g.a)({},r,a))}):e._isMounted&&e.setState({queryDto:Object(f.a)({},e.state.queryDto,Object(g.a)({},r,n))})},e.onDictionaryFieldChange=function(t){if("eyesColor"===t.target.name)e._isMounted&&e.setState({queryDto:Object(f.a)({},e.state.queryDto,{eyescolor:t.target.value})});else if("hairColor"===t.target.name)e._isMounted&&e.setState({queryDto:Object(f.a)({},e.state.queryDto,{haircolor:t.target.value})});else{var n,a,r,i=null!==(n=e.state.queryDto.interestids)&&void 0!==n?n:[];t.target.checked&&!(null===(a=i)||void 0===a?void 0:a.find((function(e){return e==t.target.name})))&&i.push(1*t.target.name),!t.target.checked&&(null===(r=i)||void 0===r?void 0:r.find((function(e){return e==t.target.name})))&&(i=i.filter((function(e){return e!=t.target.name}))),e._isMounted&&e.setState({queryDto:Object(f.a)({},e.state.queryDto,{interestids:i})})}},e.searchUsers=function(){e.searchService.searchUsers(e.state.queryDto).then((function(t){void 0!==t&&e._isMounted&&e.setState({searchResult:t})}))},e}return Object(l.a)(n,[{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0,this.props.loginInfo.loggedIn&&(this.dictionaryService.GetAllInterest().then((function(t){e._isMounted&&e.setState({interests:t})})),this.dictionaryService.GetAllEyesColors().then((function(t){e._isMounted&&e.setState({eyesColors:t})})),this.dictionaryService.GetAllHairColors().then((function(t){e._isMounted&&e.setState({hairColors:t})})))}},{key:"render",value:function(){var e=this;if(!this.props.loginInfo.loggedIn)return r.a.createElement(v.a,{to:"/login"});var t,n,a,i=this.state.queryDto;this.state.eyesColors.length>0&&(t=this.state.eyesColors.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id}," ",e.displayName," ")}))),this.state.eyesColors.length>0&&(n=this.state.hairColors.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id}," ",e.displayName," ")}))),this.state.interests.length>0&&(a=this.state.interests.map((function(t){return r.a.createElement("label",{key:t.name},r.a.createElement("input",{type:"checkbox",key:t.name,name:t.id+"",onChange:e.onDictionaryFieldChange}),t.displayName)})));var s=this.state.searchResult.length>0?this.state.searchResult:null;return r.a.createElement("div",{className:"finder"},r.a.createElement("div",{style:{display:"inline-grid",width:"35%",margin:"10px"}},r.a.createElement(R,{query:i,onFieldChange:this.onFieldChange}),r.a.createElement("label",{htmlFor:"eyesColor"},"Kolor oczu"),r.a.createElement("select",{id:"eyesColor",name:"eyesColor",onChange:this.onDictionaryFieldChange},t),r.a.createElement("label",{htmlFor:"hairColor"},"Kolor w\u0142os\xf3w"),r.a.createElement("select",{id:"hairHolor",name:"hairColor",onChange:this.onDictionaryFieldChange},n),r.a.createElement("p",null,"Zainteresowania"),a,r.a.createElement("button",{type:"submit",onClick:this.searchUsers},"Wyszukaj")),r.a.createElement("div",null,null!=s&&r.a.createElement(H,{users:s})))}}]),n}(r.a.Component),Q=Object(w.b)((function(e,t){return{loginInfo:e.loginInfo}}))(P),J=function(){function e(){Object(o.a)(this,e),this.loginEndpotint="/api/Login/Login",this.registerEndpoint="/api/login/Register",this.identityEndpoint="/api/login/Identity"}return Object(l.a)(e,[{key:"RegisterUser",value:function(e){C.ApiEndpoint,this.registerEndpoint}},{key:"LoginUser",value:function(e){var t=C.ApiEndpoint+this.loginEndpotint;return fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)}).then((function(e){if(200!==e.status)throw console.log("not logged"),Error;return e.json().then((function(e){return e}))})).catch((function(e){console.log("error:"+e)}))}},{key:"GetIdentity",value:function(e){var t=C.ApiEndpoint+this.identityEndpoint;return fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:e}}).then((function(e){return e.json().then((function(e){return e}))}))}}]),e}(),Z=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).apiQueryService=new C,a.state={login:"",password:"",authFailed:!1},a.handleLogin=function(){var e={Password:a.state.password,UserName:a.state.login},t=new J;t.LoginUser(e).then((function(e){""===e||void 0===e?a.setState({authFailed:!0}):t.GetIdentity(e).then((function(t){a.props.dispatch({type:"LOGIN_SUCCESSFUL",data:{loggedIn:!0,identity:t.toString(),apiKey:e}})}))}))},a.handleLogout=function(){a.props.dispatch({type:"LOGOUT"})},a.handleFieldChanged=function(e){a.setState(Object(g.a)({},e.target.name,e.target.value))};a.props.dispatch;return a}return Object(l.a)(n,[{key:"render",value:function(){this.apiQueryService.GetApiKey();var e=this.state.authFailed&&r.a.createElement("p",null,"Nie uda\u0142o si\u0119 zalogowa\u0107");return console.log(this.props),this.props.loginProps.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:this.handleLogout},"Log out")):r.a.createElement(r.a.Fragment,null,e,"Login: ",r.a.createElement("input",{type:"text",id:"login",name:"login",value:this.state.login,onChange:this.handleFieldChanged}),r.a.createElement("br",null),"Password: ",r.a.createElement("input",{type:"password",id:"password",name:"password",value:this.state.password,onChange:this.handleFieldChanged}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.handleLogin},"Log in"))}}]),n}(r.a.Component),V=Object(w.b)((function(e,t){return{loginProps:e.loginInfo}}))(Z),Y=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={userInterests:new Array,dataFilled:!1,ids:new Array},e.getInterstsData=function(){var t=e.state.ids;e.state.ids.length<1||(new k).GetAllInterest().then((function(n){var a=n.filter((function(e){var n;return t.indexOf(null!==(n=e.id)&&void 0!==n?n:0)>-1}));e.setState({userInterests:a,dataFilled:!0}),a.length<1&&e.setState({userInterests:null})}))},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.ids;this.setState({ids:e}),this.getInterstsData()}},{key:"render",value:function(){if(this.state.dataFilled&&null!==this.state.userInterests){var e=this.state.userInterests.map((function(e){return a.createElement("li",{key:e.id},e.displayName)}));return a.createElement("ul",null,e)}return this.getInterstsData(),a.createElement(a.Fragment,null)}}]),n}(a.Component),X=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={dictionaryItems:new Array},e.dictionaryService=new k,e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.dictionaryService.GetAllHairColors().then((function(t){e.setState({dictionaryItems:e.state.dictionaryItems.concat(t)})})),this.dictionaryService.GetAllEyesColors().then((function(t){e.setState({dictionaryItems:e.state.dictionaryItems.concat(t)})}))}},{key:"render",value:function(){var e=this,t=this.state.dictionaryItems.find((function(t){return t.id===e.props.itemId})),n="";return void 0!==t&&(n="".concat(this.props.itemName,": ").concat(t.displayName)),a.createElement(a.Fragment,null,n)}}]),n}(a.Component),$=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).goToConversation=function(){var t="/messages/conversation/"+e.props.user.basic.id;return console.log("redirect to",t),a.createElement(v.a,{to:t})},e}return Object(l.a)(n,[{key:"render",value:function(){var e,t,n,r,i,s,o,l,c,u,h=this.props.user,p=null===(e=h.details)||void 0===e?void 0:e.interests,m="/messages/conversation/".concat(h.basic.id);return a.createElement(a.Fragment,null,a.createElement(U,{user:h.basic}),a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("th",null,"Miasto"),a.createElement("td",null,null===(t=h.details)||void 0===t?void 0:t.city)),a.createElement("tr",null,a.createElement("th",null,"Wojew\xf3dztwo"),a.createElement("td",null,null===(n=h.details)||void 0===n?void 0:n.region)),a.createElement("tr",null,a.createElement("th",null,"Wzrost"),a.createElement("td",null,null===(r=h.details)||void 0===r?void 0:r.width)),a.createElement("tr",null,a.createElement("th",null,"Waga"),a.createElement("td",null,null===(i=h.details)||void 0===i?void 0:i.heigth)),a.createElement("tr",null,a.createElement("td",null,a.createElement(X,{itemName:"kolor oczu",itemId:null!==(s=null===(o=h.details)||void 0===o?void 0:o.eyesColor)&&void 0!==s?s:0}))),a.createElement("tr",null,a.createElement("td",null,a.createElement(X,{itemName:"kolor w\u0142os\xf3w",itemId:null!==(l=null===(c=h.details)||void 0===c?void 0:c.hairColor)&&void 0!==l?l:0}))),a.createElement("tr",null,a.createElement("th",null,"Zainteresowania"),a.createElement("td",null,(null===p||void 0===p?void 0:p.length)>0?a.createElement(Y,{ids:p}):a.createElement(a.Fragment,null))))),void 0!==h.basic.id?a.createElement(L,{userId:null!==(u=h.basic.id)&&void 0!==u?u:0}):void 0,a.createElement(d.b,{to:m},"Send message"),";")}}]),n}(a.Component),ee=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).usersService=new F,a.state={userId:0,userDto:{},userDetailsDto:{}},a.state={userId:e.match.params.id,userDto:{},userDetailsDto:{}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.state.userId;this.usersService.getUserDetais(t).then((function(t){e.setState({userDetailsDto:t})})),this.usersService.getUserBasic(t).then((function(t){e.setState({userDto:t})}))}},{key:"render",value:function(){var e=this.usersService.GetApiKey();if(void 0===e||null===e||""===e)return r.a.createElement(v.a,{to:"/login"});var t=this.state,n=t.userDto,a=t.userDetailsDto;if(void 0!==n&&void 0!==a){var i={basic:n,details:a};return r.a.createElement($,{user:i})}return r.a.createElement(r.a.Fragment,null)}}]),n}(r.a.Component),te=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={message:""},e.service=new N,e.sendMessage=function(){e.service.SendMessage(e.props.userId,e.state.message),e.setState({message:""})},e.contentChanged=function(t){e.setState({message:t.target.value})},e}return Object(l.a)(n,[{key:"render",value:function(){return a.createElement("div",null,a.createElement("textarea",{style:{width:"400px",height:"50px"},onChange:this.contentChanged,value:this.state.message}),a.createElement("br",null),a.createElement("button",{onClick:this.sendMessage},"Wy\u015blij"))}}]),n}(a.Component),ne=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).conversationIntervalId=void 0,a.state={userId:0,conversation:new Array,speaker:{}},a.getGonversation=function(){a.service.GetConversation(a.state.userId).then((function(e){a.setState({conversation:e})}))},a.service=new N,a.userService=new F,a.state={userId:e.match.params.id,conversation:new Array,speaker:{}},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.getGonversation(),this.conversationIntervalId=setInterval(this.getGonversation,1e3),this.userService.getUserBasic(this.state.userId).then((function(t){e.setState({speaker:t})}))}},{key:"componentWillUnmount",value:function(){clearInterval(this.conversationIntervalId)}},{key:"render",value:function(){var e,t={color:"white",backgroundColor:"DodgerBlue",padding:"10px",fontFamily:"Arial",margin:"10px"},n=this.state.speaker,r="/user/".concat(n.id),i=this.state.conversation.map((function(e){var n,r;return a.createElement("div",{style:t,key:null!==(n=null===(r=e.sendDate)||void 0===r?void 0:r.toString())&&void 0!==n?n:""},a.createElement("strong",null," ",e.senderName)," | ",e.sendDate,"  ",a.createElement("br",null),e.content)}));return a.createElement("div",null,a.createElement("h3",null,"conversation with ",a.createElement(d.b,{to:r}," ",n.displayName)),a.createElement(te,{userId:null!==(e=n.id)&&void 0!==e?e:0}),i)}}]),n}(a.Component),ae=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.d,null,r.a.createElement(v.b,{path:"/",exact:!0,component:A}),r.a.createElement(v.b,{path:"/friends",exact:!0,component:B}),r.a.createElement(v.b,{path:"/messages",exact:!0,component:W}),r.a.createElement(v.b,{path:"/search",exact:!0,component:Q}),r.a.createElement(v.b,{path:"/login",exact:!0,component:V}),r.a.createElement(v.b,{path:"/user/:id",exact:!0,component:ee}),r.a.createElement(v.b,{path:"/messages/conversation/:id",exact:!0,component:ne})))},re=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement("div",{className:"app"},r.a.createElement("header",null,r.a.createElement(h,null)),r.a.createElement("main",null,r.a.createElement("aside",null,r.a.createElement(m,null)),r.a.createElement("section",{className:"page"},r.a.createElement(ae,null)))))}}]),n}(r.a.Component);s.a.render(r.a.createElement(w.a,{store:b},r.a.createElement(re,null)),document.getElementById("root"))},70:function(e,t,n){e.exports=n(141)},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){}},[[70,1,2]]]);
//# sourceMappingURL=main.7c646e23.chunk.js.map